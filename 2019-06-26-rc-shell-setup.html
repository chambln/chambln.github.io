<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-GB" xml:lang="en-GB">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Gregory Chamberlain" />
  <title>Guide to Installing the rc Shell with Line Editing in Linux</title>
  <style>
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <style>
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="main.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
  <script>var clicky_site_ids = clicky_site_ids || []; clicky_site_ids.push(101207153);</script>
  <script async src="//static.getclicky.com/js"></script>
</head>
<body>
<header>
    <a href="index.html">
        <h1 id="logo">(<b>cosine</b><span style="padding: 0 0.25em">.</span><span style="color:black;">blue</span>)</h1>
    </a>
</header>
<header id="title-block-header">
<h1 class="title">Guide to Installing the <em>rc</em> Shell with Line Editing in Linux</h1>
<div class="subtitle"><p>How to compile and install Byron Rakitzis’ reimplementation of the <em>rc</em> shell from Plan 9—an expressive and thoughtfully designed alternative to the ubiquitous Bourne-compatible shells of today.</p></div>
<p class="author"><a href="contact.html">Gregory Chamberlain</a></p>
<p class="date">Wednesday 26 June, 2019</p>
</header>
<article>
<h1 id="introduction"><span class="header-section-number">1</span> Introduction</h1>
<p>This article demonstrates how to download, compile and install Byron Rakitzis’ reimplementation of the <em>rc</em> shell, originally from the Plan 9 system. The first section is a brief history of <em>rc</em> and some of its newer forms, but feel free to skip ahead to the actual guide.</p>
<h1 id="history"><span class="header-section-number">2</span> History</h1>
<p>Around 10 years or so after creating Unix, the Computing Science Research Center at AT&amp;T Bell Labs developed the <a href="https://9p.io/plan9">Plan 9</a> operating system, which further riffed on the Unix philosophy. It was only used internally at Bell Labs until the early '90s when they made it available to universities and businesses. Eventually they released it under an open-source license. Today it’s only really used by hobbyists and people learning about operating systems.</p>
<p>Anyway, <em>rc</em> (short for <em>“run commands”</em>) was the system’s canonical command-line interpreter, and it’s ace. Its syntax is much simpler than that of the established Bourne shell from which Bash and most other contemporary shells derive; and <em>rc</em>'s handling of strings and special characters makes it less error-prone overall.</p>
<p>Many tools from Plan 9, including its fantastic <em>rc</em> shell, have been ported to Unix-like systems under the name <em><a href="https://9fans.github.io/plan9port">Plan 9 from User Space</a></em> (a.k.a. plan9port). A subset of these programs packaged as <a href="http://tools.suckless.org/9base/">9base</a> is provided by Suckless. The two are probably available from your distribution’s package repository (but keep reading).</p>
<p>An independent project by Byron Rakitzis saw a reimplementation of the <em>rc</em> shell for Unix-like systems. His implementation differs very slightly from the <em>true</em> Plan 9 shell (as ported by plan9port), but before compiling it can be linked with line-editing libraries such as GNU readline, which is why I much prefer it for interactive use.</p>
<h1 id="install-the-rc-shell"><span class="header-section-number">3</span> Install the <em>rc</em> shell</h1>
<p>I recommend installing <a href="https://github.com/rakitzis/rc" title="rc shell -- independent re-implementation for Unix of the Plan 9 shell (from circa 1992).">Byron Rakitzis’ reimplementation of <em>rc</em></a>, which provides such nice features as <strong>line editing</strong> and <strong>tab completions</strong>.</p>
<h2 id="compile-from-source"><span class="header-section-number">3.1</span> Compile from source</h2>
<p>Clone the GitHub repository and run the bootstrap script:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">git</span> clone https://github.com/rakitzis/rc</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="bu">cd</span> rc</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="ex">./bootstrap</span></span></code></pre></div>
<p>This generates an <code>INSTALL</code> file with detailed instructions. Then configure and build like so:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">sh</span> configure --with-edit=readline</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="fu">make</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="fu">sudo</span> make install</span></code></pre></div>
<p>You now have <em>rc</em> installed on your machine. To uninstall, use <code>sudo make uninstall</code> in that same directory.</p>
<h1 id="start-the-rc-shell"><span class="header-section-number">4</span> Start the <em>rc</em> shell</h1>
<p>You may need to log out and back in for it to work. Start the shell by typing</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1"></a><span class="ex">rc</span></span></code></pre></div>
<p>or, in order to have <em>rc</em> behave as a <strong>login shell</strong>, pass the <code>-l</code> flag:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb4-1"><a href="#cb4-1"></a><span class="ex">rc</span> -l</span></code></pre></div>
<p>As described in the manual (<code>man rc</code>), this tells <em>rc</em> to source <code>$home/.rcrc</code> when it starts.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> Much like one’s <a href="https://wiki.archlinux.org/index.php/Bash#Configuration_files"><code>.bashrc</code></a>, you might like to populate that file with commands that</p>
<ul>
<li>change your <code>$prompt</code></li>
<li>change your <code>$path</code><a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a></li>
<li>define functions,</li>
<li>assign environment variables,</li>
<li>do whatever else.</li>
</ul>
<p>The default prompt is a semicolon, which seems an odd choice. According to the manual,</p>
<blockquote>
<p>[t]he reason for this is that it enables an <em>rc</em> user to grab commands from previous lines using a mouse, and to present them to <em>rc</em> for re-interpretation; the semicolon prompt is simply ignored by <em>rc</em>.</p>
</blockquote>
<p>To quit the shell, press CTRL-D or type</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb5-1"><a href="#cb5-1"></a><span class="bu">exit</span></span></code></pre></div>
<h1 id="make-rc-your-login-shell"><span class="header-section-number">5</span> Make <em>rc</em> your login shell</h1>
<p>When you open your terminal, the first program it runs is your <strong>login shell</strong>. On most Linux machines, users’ login shells are set to Bash by default. Changing your login shell is easy to do.</p>
<p>Firstly, add <em>rc</em>’s full path to your machine’s list of approved login shells. This must be done as root, as so:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">sudo</span> su -c <span class="st">&#39;which rc &gt;&gt; /etc/shells&#39;</span></span></code></pre></div>
<p>Let’s do this next step in an <em>rc</em> shell, demonstrating its backquote substitution (analogous to the Bourne shell’s command substitution). And we’ll use the built-in <a href="http://man7.org/linux/man-pages/man1/chsh.1.html"><code>chsh</code></a> utility:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb7-1"><a href="#cb7-1"></a><span class="ex">rc</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="fu">chsh</span> <span class="va">$USER</span> --shell <span class="kw">`{</span> <span class="fu">which</span> rc <span class="kw">}</span></span></code></pre></div>
<p>That’s it! Next time you log in as the same user, your tty and terminals will start with the <em>rc</em> shell.<a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a> This has had no effect on other users; so if your <em>rc</em> executable breaks or disappears, you can simply log in as root and change your shell back to Bash or what have you.</p>
<h2 id="make-use-of-run-commands"><span class="header-section-number">5.1</span> Make use of run commands</h2>
<p>Many users like to use <code>la</code> as an alias to <code>ls -A</code>. To implement this in our <em>rc</em>, let’s define a function in <strong><code>$home/.rcrc</code></strong>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb8-1"><a href="#cb8-1"></a><span class="ex">fn</span> la { ls -A <span class="va">$*</span> }   </span></code></pre></div>
<p>In short, <code>fn</code> is the keyword for creating functions, and the braces contain the sequence of commands the function shall execute. Arguments of the function are stored in <code>$1</code>, <code>$2</code>, etc., but <code>$*</code> stores the list of <em>all</em> arguments given, which we humbly and helpfully pass straight through to the <code>ls</code> program.</p>
<p>I found that I had to log out and back in for the updated <code>$home/.rcrc</code> to be sourced automatically; starting a new instance of <em>rc</em> was not enough. But we can source the new commands manually with the <code>.</code> built-in, as so:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb9-1"><a href="#cb9-1"></a><span class="bu">.</span> <span class="va">$home</span><span class="ex">/.rcrc</span></span></code></pre></div>
<p>or, if we’re already in the home directory, simply</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="#cb10-1"></a><span class="bu">.</span> <span class="ex">.rcrc</span></span></code></pre></div>
<section class="footnotes" role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>In <em>rc</em>, the home directory is stored in both the lowercase variable <code>$home</code> and the usual uppercase environment variable <code>$HOME</code>.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>In <em>rc</em>, the built-in <code>$path</code> variable is a list of directories that is kept in sync with the usual <code>$PATH</code> environment variable, a colon-separated string of the same directories.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3" role="doc-endnote"><p>I’ve tested this with <a href="https://st.suckless.org/">st</a> and <a href="https://wiki.archlinux.org/index.php/Rxvt-unicode">rxvt-unicode</a>, which identify the user’s shell by reading /etc/passwd (which is what <code>chsh</code> changes). Other terminals may need additional configuration.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4" role="doc-endnote"><p>Unlike the Bourne shell, <em>rc</em> does not support aliases. Use functions instead! The <code>builtin</code> keyword should be used to avoid infinite recursion.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</article>
<footer>
    © 2019 Gregory L. Chamberlain
</footer>
</body>
</html>
